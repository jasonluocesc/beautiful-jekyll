---
layout: post
title: 数据库事务ACID特性
subtitle:
tags: [数据库]
---
我们日常提到的ACID，是指数据库管理系统在更新数据的过程中，为保证事务可靠，所必须具备的四个特性，原子性，一致性，不可分割性，持久性。

在数据库系统中，事务是指一系列数据库操作组成的一个完整的逻辑过程，如一次完整的银行转账，从原账户扣除金额，以及向目标账户添加金额，这两个数据库操作的总和，整个过程成为一个事务，具备ACID特性。

### 1.Atomicity （原子性）
原子性遵循（All or Nothing）原则，即要么全部完成，要么全都不完成，不会结束在中间某个环节。事务在执行过程中发生错误，会被回滚（Rollback）到事务开始前的状态，就如同从未发生过一样。
### 2.Consistency （一致性）
一致性保证只有完全符合数据库规定规则和约束条件的数据被写入到数据库中，
### 3.Isolation （隔离性）
并发事务之间互相影响的程度。
在事务并发操作时，可能出现的问题有：
* 脏读：事务A修改了一个数据，但未提交，事务B读到了事务A未提交的更新结果，如果事务A提交失败，事务B读到的就是脏数据。
* 不可重复读： 在同一个事务中，对于同一份数据读取到的结果不一致。比如，事务B在事务A提交前读到的结果，和提交后读到的结果可能不同。不可重复读出现的原因就是事务并发修改记录，要避免这种情况，最简单的方法就是要对修改的记录加锁，但如此会导致竞争加剧，影响性能。
* 幻读：在同一个事务中，同一个查询多次返回的结果不一致。事务A新增了一条记录，事务B在事务A提交前后各执行了一次查询操作，发现后一次比前一次多了一条记录。幻读是事务并发增加记录导致的，这个不能像不可重复读通过加锁解决，因为对于新增的记录根本无法加锁，需要将事务串行化。

事务的隔离界别从低到高有：
* Read Uncommitted：最低的隔离级别，什么都不需要做，一个事务可以读到另一个事务未提交的结果。所有的并发事务问题都会发生。
* Read Committed：只有在事务提交后，其更新结果才会被其他事务看见。可以解决<span style="color:red">脏读</span>问题。
* Repeated Read：在一个事务中，对于同一份数据的读取结果总是相同的，无论是否有其他事务对这份数据进行操作，以及这个事务是否提交。可以解决<span style="color:red">脏读、不可重复读</span>。
* Serialization：事务串行化执行，隔离级别最高，牺牲了系统的并发性。可以解决并发事务的<span style="color:red">所有问题</span>。
### 4.Durability （持久性）
持久性指的是只要事务成功结束，其对数据库的更新就会永远保留下来。不受系统崩溃，断电等影响。